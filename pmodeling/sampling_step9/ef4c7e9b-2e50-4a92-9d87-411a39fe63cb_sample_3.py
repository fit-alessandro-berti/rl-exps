import pm4py
from pm4py.objects.powl.obj import StrictPartialOrder, OperatorPOWL, Transition, SilentTransition
from pm4py.objects.process_tree.obj import Operator

seed_selection = Transition(label='Seed Selection')
nutrient_mix = Transition(label='Nutrient Mix')
environment_setup = Transition(label='Environment Setup')
pest_scan = Transition(label='Pest Scan')
light_control = Transition(label='Light Control')
growth_monitor = Transition(label='Growth Monitor')
water_cycle = Transition(label='Water Cycle')
air_quality = Transition(label='Air Quality')
robotic_harvest = Transition(label='Robotic Harvest')
quality_check = Transition(label='Quality Check')
data_logging = Transition(label='Data Logging')
packaging = Transition(label='Packaging')
waste_sort = Transition(label='Waste Sort')
energy_audit = Transition(label='Energy Audit')
retail_sync = Transition(label='Retail Sync')

skip = SilentTransition()
xor = OperatorPOWL(operator=Operator.XOR, children=[nutrient_mix, environment_setup])
xor2 = OperatorPOWL(operator=Operator.XOR, children=[pest_scan, light_control])
xor3 = OperatorPOWL(operator=Operator.XOR, children=[growth_monitor, water_cycle])
xor4 = OperatorPOWL(operator=Operator.XOR, children=[air_quality, robotic_harvest])
xor5 = OperatorPOWL(operator=Operator.XOR, children=[quality_check, data_logging])
xor6 = OperatorPOWL(operator=Operator.XOR, children=[packaging, waste_sort])
xor7 = OperatorPOWL(operator=Operator.XOR, children=[energy_audit, retail_sync])

loop1 = OperatorPOWL(operator=Operator.LOOP, children=[xor, xor2, xor3, xor4, xor5, xor6, xor7])
loop2 = OperatorPOWL(operator=Operator.LOOP, children=[seed_selection, loop1])
loop3 = OperatorPOWL(operator=Operator.LOOP, children=[loop2])

root = StrictPartialOrder(nodes=[loop3])
root.order.add_edge(loop3, seed_selection)
root.order.add_edge(seed_selection, loop1)
root.order.add_edge(loop1, xor)
root.order.add_edge(loop1, xor2)
root.order.add_edge(loop1, xor3)
root.order.add_edge(loop1, xor4)
root.order.add_edge(loop1, xor5)
root.order.add_edge(loop1, xor6)
root.order.add_edge(loop1, xor7)
root.order.add_edge(xor, nutrient_mix)
root.order.add_edge(xor, environment_setup)
root.order.add_edge(xor2, pest_scan)
root.order.add_edge(xor2, light_control)
root.order.add_edge(xor3, growth_monitor)
root.order.add_edge(xor3, water_cycle)
root.order.add_edge(xor4, air_quality)
root.order.add_edge(xor4, robotic_harvest)
root.order.add_edge(xor5, quality_check)
root.order.add_edge(xor5, data_logging)
root.order.add_edge(xor6, packaging)
root.order.add_edge(xor6, waste_sort)
root.order.add_edge(xor7, energy_audit)
root.order.add_edge(xor7, retail_sync)